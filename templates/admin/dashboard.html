{% extends 'admin/base.html' %}

{% block title %}Admin Dashboard{% endblock title %}
{% block page_heading %}Admin Dashboard{% endblock page_heading %}

{% block content %}
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <!-- Low Stock Items Card -->
    <div class="bg-white p-6 rounded-lg shadow-md">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Low Stock Items</h3>
        <ul class="space-y-2">
            {% set low_stock_found = false %}
            {% for item in inventory_items %}
                {% if item.current_stock_quantity < item.reorder_level %}
                    <li class="flex justify-between items-center bg-red-100 p-3 rounded-md text-sm text-red-800 font-medium">
                        <span>{{ item.name }}</span>
                        <span>{{ item.current_stock_quantity }} {{ item.unit }} (Reorder: {{ item.reorder_level }} {{ item.unit }})</span>
                    </li>
                    {% set low_stock_found = true %}
                {% endif %}
            {% endfor %}
            {% if not low_stock_found %}
                <li class="text-gray-500">No items currently below reorder level.</li>
            {% endif %}
        </ul>
        <div class="mt-4 text-right">
            <a href="{{ url_for('admin.inventory') }}" class="text-blue-600 hover:underline text-sm">View All Inventory</a>
        </div>
    </div>

    <!-- Pending Orders Card -->
    <div class="bg-white p-6 rounded-lg shadow-md">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Pending Orders</h3>
        {% if pending_orders %}
        <ul class="space-y-2">
            {% for order in pending_orders %}
            <li class="flex justify-between items-center bg-yellow-100 p-3 rounded-md text-sm text-yellow-800">
                <span>Order #{{ order.id }} ({{ order.supplier.name if order.supplier else 'N/A' }})</span>
                <span class="font-medium">{{ order.order_date.strftime('%Y-%m-%d') }}</span>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p class="text-gray-500">No pending orders.</p>
        {% endif %}
        <div class="mt-4 text-right">
            <a href="{{ url_for('admin.orders') }}" class="text-blue-600 hover:underline text-sm">View All Orders</a>
        </div>
    </div>

    <!-- Upcoming Tasks Card -->
    <div class="bg-white p-6 rounded-lg shadow-md">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Upcoming Tasks</h3>
        {% if upcoming_tasks %}
        <ul class="space-y-2">
            {% for task in upcoming_tasks %}
            <li class="flex justify-between items-center bg-blue-100 p-3 rounded-md text-sm text-blue-800">
                <span>{{ task.title }}</span>
                <span class="font-medium">Due: {{ task.due_date.strftime('%Y-%m-%d') if task.due_date else 'N/A' }}</span>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p class="text-gray-500">No upcoming tasks.</p>
        {% endif %}
        <div class="mt-4 text-right">
            <a href="{{ url_for('admin.tasks') }}" class="text-blue-600 hover:underline text-sm">View All Tasks</a>
        </div>
    </div>

    <!-- Expiring Batches Card -->
    <div class="bg-white p-6 rounded-lg shadow-md">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Expiring Batches (Next 30 Days)</h3>
        {% if expiring_batches %}
        <ul class="space-y-2">
            {% for batch in expiring_batches %}
            <li class="flex justify-between items-center bg-orange-100 p-3 rounded-md text-sm text-orange-800">
                <span>{{ batch.good.name }} (Batch: {{ batch.batch_number }})</span>
                <span class="font-medium">Expires: {{ batch.expiry_date.strftime('%Y-%m-%d') }}</span>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p class="text-gray-500">No batches expiring soon.</p>
        {% endif %}
        <div class="mt-4 text-right">
            <a href="{{ url_for('admin.inventory') }}" class="text-blue-600 hover:underline text-sm">Manage Batches (via Inventory)</a>
        </div>
    </div>

    <!-- Add more admin-specific cards here if needed -->
</div>
{% endblock content %}
